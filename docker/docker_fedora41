FROM fedora:41

ARG DEBIAN_FRONTEND=noninteractive

RUN dnf update -y \
    && dnf install -y \
    https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm \
    https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm \
    && dnf update -y \
    && dnf install -y \
      which \
      @development-tools gcc-c++ \
      wget curl python3 \
      ca-certificates \
      pkgconfig \
      ffmpeg ffmpeg-devel \
      libass libass-devel \
      opencl-headers \
      libX11-devel \
      vulkan-loader-devel \
      rpm-build \
      openssl openssl-devel \
    && dnf clean all

ENV RUSTUP_HOME=/usr/local/rustup
ENV CARGO_HOME=/usr/local/cargo
ENV PATH=/usr/local/cargo/bin:$PATH

RUN curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs \
      | sh -s -- -y --profile minimal \
    && /usr/local/cargo/bin/rustup show \
    && /usr/local/cargo/bin/cargo --version \
    && /usr/local/cargo/bin/cargo install cargo-c --locked \
    && /usr/local/cargo/bin/cargo cbuild --version

WORKDIR /work


